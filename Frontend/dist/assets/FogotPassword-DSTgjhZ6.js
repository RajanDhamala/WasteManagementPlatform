import{E as y,r as o,a0 as C,A as O,j as e,C as r,_ as E,a2 as T,b as h}from"./index-3_z3CT1Q.js";import{M as x}from"./mail-BZSy2IOE.js";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]],g=y("KeyRound",z);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],k=y("Shield",V);function R(){const[l,f]=o.useState(""),[c,v]=o.useState(["","","","","",""]),[b,p]=o.useState("email"),[A,d]=o.useState(null),u=o.useRef([]);C();const n=O(t=>t.setAlert),m={hidden:{opacity:0,scale:.9},visible:{opacity:1,scale:1,transition:{delayChildren:.3,staggerChildren:.2}}},i={hidden:{y:20,opacity:0},visible:{y:0,opacity:1,transition:{duration:.5}}},j=(t,a)=>{const s=[...c];s[t]=a,v(s),a&&t<5&&u.current[t+1].focus()},w=(t,a)=>{a.key==="Backspace"&&!c[t]&&t>0&&u.current[t-1].focus()},N=async t=>{var a;t.preventDefault();try{const{data:s}=await h.post("http://localhost:8000/user/forgotpassword",{email:l});s.success?(n({type:"success",message:"OTP sent to your email",title:"Success"}),p("otp")):n({type:"error",message:"Failed to send OTP",title:"Error"})}catch(s){const P=((a=s.response)==null?void 0:a.status)===429?"You have exceeded the maximum number of attempts. Please try again later.":"Failed to send OTP";n({type:"error",message:P,title:"Error"})}},S=async t=>{t.preventDefault();const a=c.join("");d(null);try{const s=await h.post("http://localhost:8000/user/verifyPasswordOtp",{email:l,otp:a},{withCredentials:!0});console.log(s.data),s.data.success?(n({type:"success",message:"OTP verified successfully",title:"Success"}),d("success"),setTimeout(()=>{},2e3)):(n({type:"error",message:s.data.message||"Invalid OTP. Please try again.",title:"Error"}),d("error"))}catch{d("error"),n({type:"error",message:"Failed to verify OTP",title:"Error"})}};return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-green-50 to-green-200 p-4",children:e.jsx(r.div,{variants:m,initial:"hidden",animate:"visible",className:"w-full max-w-md bg-white p-8 rounded-2xl shadow-2xl space-y-6",children:e.jsx(E,{mode:"wait",children:b==="email"?e.jsxs(r.form,{variants:m,initial:"hidden",animate:"visible",exit:"hidden",onSubmit:N,className:"space-y-6",children:[e.jsxs(r.div,{variants:i,className:"text-center",children:[e.jsx(x,{className:"mx-auto text-green-500 mb-4",size:48}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Forgot Password"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Enter your email to reset password"})]}),e.jsxs(r.div,{variants:i,className:"relative",children:[e.jsx("input",{type:"email",value:l,onChange:t=>f(t.target.value),placeholder:"Enter your email",required:!0,className:"w-full px-4 py-3 pl-10 border-2 border-green-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"}),e.jsx(x,{className:"absolute left-3 top-3.5 text-green-400",size:20})]}),e.jsxs(r.button,{variants:i,whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",className:"w-full bg-green-500 text-white py-3 rounded-xl hover:bg-green-600 transition duration-300 flex items-center justify-center",children:[e.jsx(k,{className:"mr-2",size:20}),"Send OTP"]})]},"email-form"):e.jsxs(r.form,{variants:m,initial:"hidden",animate:"visible",exit:"hidden",onSubmit:S,className:"space-y-6",children:[e.jsxs(r.div,{variants:i,className:"text-center",children:[e.jsx(g,{className:"mx-auto text-green-500 mb-4",size:48}),e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Verify OTP"}),e.jsxs("p",{className:"text-gray-600 mt-2",children:["Enter 6-digit code sent to ",l]})]}),e.jsx(r.div,{variants:i,className:"grid grid-cols-6 gap-2",children:c.map((t,a)=>e.jsx(r.input,{variants:i,type:"text",ref:s=>u.current[a]=s,maxLength:1,value:t,onChange:s=>j(a,s.target.value),onKeyDown:s=>w(a,s),pattern:"\\d*",inputMode:"numeric",className:"w-full text-center py-3 border-2 border-green-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500",whileFocus:{scale:1.1,borderColor:"rgb(34 197 94)"}},a))}),e.jsxs(r.div,{variants:i,className:"flex justify-between items-center mt-6",children:[e.jsxs(r.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"button",onClick:()=>p("email"),className:"text-green-500 hover:underline flex items-center",children:[e.jsx(T,{className:"mr-2",size:20}),"Change Email"]}),e.jsxs(r.button,{whileHover:{scale:1.05},whileTap:{scale:.95},type:"submit",className:"bg-green-500 text-white px-6 py-3 rounded-xl hover:bg-green-600 transition duration-300 flex items-center",children:[e.jsx(g,{className:"mr-2",size:20}),"Verify OTP"]})]})]},"otp-form")})})})}export{R as default};
